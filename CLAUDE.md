# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

A client-side JavaScript library that integrates with the [Lever Postings API](https://github.com/lever/postings-api) to display and filter job postings on websites. Uses esbuild to bundle source files into a single production file.

## Architecture

**`index.js`** is the production bundle, generated by `npm run build` from the source files in `src/`. Do not edit `index.js` directly — edit the source files and rebuild.

Source files in `src/`:
1. **`src/list.js`**: List.js library (vendored) — search, filtering, and list manipulation
2. **`src/loader.js`**: Fetches from Lever API, groups by department/team, renders HTML
3. **`src/filters.js`**: Builds filter dropdowns, handles search/filter UI via jQuery + List.js

**`build.js`** concatenates the source files and runs them through esbuild's `transform` API (for transpilation/minification only, no module wrapping).

**Data flow:**
1. `window.leverJobsOptions` configures account name and optional department filter
2. Loader fetches `https://api.lever.co/v0/postings/{account}?group=team&mode=json` (public, no auth)
3. Response is grouped by team; `createJobs()` re-organizes into Department → Team → Posting hierarchy
4. HTML is rendered into `#lever-jobs-container` with `data-*` attributes for filtering
5. `leverJobsRendered` event fires, triggering filter initialization
6. Filters clone job elements into `#new-list` for List.js to manage search/filter independently

## Key API Details

- Uses the **Lever Postings API v0** (public, unauthenticated) — NOT the authenticated Lever API v1
- The `group=team` parameter returns `[{ title, postings: [...] }, ...]` instead of a flat array
- Default limit is 100 postings per request; pagination uses `skip`/`limit` query params
- Rate limit: 2 POST requests/second; handle HTTP 429 responses

## Configuration

```javascript
window.leverJobsOptions = {
  accountName: 'CompanyName',        // required
  departmentFilter: ['Engineering']  // optional, case-insensitive
};
```

When `departmentFilter` is set, `window.leverDepartmentFilterActive` is set to `true` and the department dropdown is hidden.

## Build

```bash
npm install          # install esbuild
npm run build        # bundle src/ → index.js
npm run build:min    # bundle src/ → index.min.js (minified)
npm run build:all    # build both
```

## Dependencies

- **jQuery 3.6.1** (`jquery-3.6.1.js`) — used in filters for DOM manipulation
- **List.js** (`src/list.js` / bundled in `index.js`) — search and filter engine
- **esbuild** (dev dependency) — bundler

## File Roles

| File | Role |
|------|------|
| `index.js` | Production bundle (build output — do not edit) |
| `index.min.js` | Minified production bundle (build output) |
| `build.js` | Build script (concatenates src/ files via esbuild transform) |
| `src/list.js` | Source: List.js library (vendored) |
| `src/loader.js` | Source: API fetching and HTML rendering |
| `src/filters.js` | Source: Search/filter dropdown logic |
| `index.html` | Demo page with full integration example |
| `style.css` | Styling with mobile breakpoint at 767px |
